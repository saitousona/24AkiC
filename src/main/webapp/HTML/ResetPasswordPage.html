<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>パスワード変更画面</title>
    <script>
        function validatePassword() {
            const newPassword = document.querySelector('input[name="new_password"]').value;
            const confirmPassword = document.querySelector('input[name="confirm_password"]').value;
            const errorMessages = [];

            // パスワードの長さをチェック
            if (newPassword.length < 8 || newPassword.length > 64) {
                errorMessages.push("パスワードは8文字以上64文字以下でなければなりません。");
            }
            // 大文字が含まれているかチェック
            if (!/[A-Z]/.test(newPassword)) {
                errorMessages.push("パスワードには少なくとも1つの大文字を含める必要があります。");
            }
            // 小文字が含まれているかチェック
            if (!/[a-z]/.test(newPassword)) {
                errorMessages.push("パスワードには少なくとも1つの小文字を含める必要があります。");
            }
            // 数字が含まれているかチェック
            if (!/[0-9]/.test(newPassword)) {
                errorMessages.push("パスワードには少なくとも1つの数字を含める必要があります。");
            }
            // 3文字以上の連続した同じ文字が含まれているかチェック
            if (/(.)\1{2,}/.test(newPassword)) {
                errorMessages.push("パスワードには3文字以上の連続した同じ文字を含めることはできません。");
            }
            // パスワードと確認用パスワードが一致するかチェック
            if (newPassword !== confirmPassword) {
                errorMessages.push("新しいパスワードと確認用パスワードが一致しません。");
            }

            // エラーメッセージがある場合、表示してフォーム送信をキャンセル
            if (errorMessages.length > 0) {
                alert(errorMessages.join("\n"));
                return false; // フォーム送信をキャンセル
            }
            return true; // フォーム送信を許可
        }
    </script>
</head>
<body>
    <form action="/24AkiC/ResetPasswordServlet" method="post" onsubmit="return validatePassword()">
        <label for="email">Email:</label>
        <input type="email" name="email" required>
        <label for="secret_word">Secret Word:</label>
        <input type="text" name="secret_word" required>
        <label for="new_password">新しいパスワード:</label>
        <input type="password" name="new_password" required>
        <label for="confirm_password">確認用パスワード:</label>
        <input type="password" name="confirm_password" required>
        <button type="submit">確認</button>
    </form>
</body>
</html>
